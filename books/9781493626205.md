# [Sudo Mastery](https://www.amazon.com/Michael-Lucas-Mastery-2013-11-24-Paperback/dp/B00L8GSQEC/ref=sr_1_2?keywords=sudo+mastery&qid=1665470404&qu=eyJxc2MiOiIwLjg3IiwicXNhIjoiMC45OSIsInFzcCI6IjAuOTIifQ%3D%3D&sr=8-2)
<img alt="9781493626205" src="../covers/9781493626205.jpg" width="200"/>

> The best resource to know about sudo in depth.

## Chapter 1/13

<details>
<summary>What are the sudo proprietary alternatives on Unix systems?</summary>

* OpenSolaris-based systems have `pfexec` and role-based access control.
* HP has `pbrun`.
* `sudo` on other Unix systems.
</details>

* [sudo](https://sudo.wd)

<details>
<summary>What version of sudo should be installed on a server at least?</summary>

> v1.8.8 is the least version.
> Older than that need to immediately be upgraded by source or prebuilt packages.
</details>

## Chapter 2/13

<details>
<summary>How to run a command with root privileges using <code>sudo</code>?</summary>

```sh
sudo command
```
</details>

* [sudo(1)](https://manpages.org/sudo/1)

<details>
<summary>How to run a command on behalf of a specific user with sudo?</summary>

```sh
sudo -u user command
```
</details>

<details>
<summary>How to run a command on behalf of a specific group with sudo?</summary>

> When group ID is desired, put a escaped hash mark before the GID, unless you're on `tcsh` shell.

```sh
sudo -g group command
sudo -g \#gid command
```
</details>

<details>
<summary>Where are the sudo rules stored on system and how can it be editted properly?</summary>

> sudo rules are in `/etc/sudoers` but should never be editted by hand.
> `visudo` should always be used to change sudo rules.
</details>

<details>
<summary>What is the general form of each line of sudo rules and what is the definition and scope of each part?</summary>

> `username` might also be a system group, or an alias defined within sudoers.
> `host` is the hostname of the system that this rule applies to when sudoers file is shared across multiple systems.
> `command` lists the full path to each command this rule applies to.
> `ALL` matches every possible option for each of these parts.

```conf
username host = command
```
</details>

<details>
<summary>Why is it best practice to specify a specific <code>hostname</code> rather than <code>ALL</code> in sudo rules?</summary>

> Most commonly ALL is ste as `host` because most system administrators configure sudo on per-host basis.
> Separately managing every server and defining the server as `ALL` means "this server", but it's best practice to put the server name as `host`.
</details>

<details>
<summary>How to specify multiple options on each sudo rule?</summary>

```sh
sofia,nora,lucy ubuntu = /user/bin/mount, /usr/bin/umount
```

> Users `sofia`, `nora`, and `lucy` can run `mount` and `umount` commands on the server `ubuntu`.
</details>

<details>
<summary>How to specify commands to run by a specific user on behalf some other user except root in sudo rules?</summary>

> Some applications must run by specific users to work correctly.
> A user other than `root` can be specified in parenthesis, if sudo policy permits it.

```sh
emma debian = (oracle) ALL
```

> User `emma` can run any commands on the server `debian`, but only as the user `oracle`.
</details>

<details>
<summary>Can sudo rules be specified multiple times for users on different hosts and commands?</summary>

> Yes, separate rules on each line, but separate users, hosts and commands by comman on one line as much as possible.

```cpp
elena www = (oracle) ALL
elena www = /usr/bin/mount, /usr/bin/umount
```
</details>

<details>
<summary>How to break long rules into multiple lines?</summary>

> End a line with a backslash to continue rules on the next line.

```sh
emma,elena,sofia www,dns,mail = /usr/bin/mount, /usr/bin/umount, \
    /usr/bin/fdisk
```
</details>

<details>
<summary>What rules match in sudo when multiple rules exist in sudoers file?</summary>

> Last matching rule wins.
> If two rules conflict, the last matching rule wins.
</details>

<details>
<summary>How to use negate operator to exclude one item from a list in sudoers file?</summary>

> Negation operator `!` can be used to apply to everything except a specific user, host ro command.
> Negation operator `!` can also be used to turn off options.
</details>

<details>
<summary>What must be written in the last line of sudoers file to be accepted by visudo?</summary>

> Last sudoers line must be an empty line, otherwise visudo comlains it.
</details>

## Chapter 3/13

<details>
<summary>What editor does the <code>visudo</code> use to edit <code>/etc/sudoers</code> file?</summary>

> Default editor for `visudo` is `vi` which is in most of the systems are linked to `vim`.

```sh
export EDITOR=/usr/bin/vim
visudo
```
</details>

## Chapter 4/13
## Chapter 5/13
## Chapter 6/13
## Chapter 7/13
## Chapter 8/13
## Chapter 9/13
## Chapter 10/13
## Chapter 11/13
## Chapter 12/13
## Chapter 13/13
